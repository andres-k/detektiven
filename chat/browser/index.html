<!doctype html>
<html>

  <head>
      <title>detektiven</title>
      <link rel="stylesheet" href="css/default.css">
      <script src="bundle.js"></script>
      <script src="vendor/web-eid/web-eid.js"></script>
  </head>

  <body>

      <noscript>
        <center>
          <h1>JavaScript is disabled</h1>
            <p><b>detektiven</b> is Single Page Application written in javascript</p>
            <p>Please enable javascript and refresh the page</p>
            <p><a href="http://enable-javascript.com">Instructions are available on <b>enable-javascript.com</b></a></p>
        </center>
      </noscript>

      <div id="main"><div/>

      <script>
        var m = document.getElementById("main");
        var p = document.createElement("h1",{id:"msg"});
        m.appendChild(p);
        webeid.hasExtension().then(function (d) {
          webeid.getVersion().then(function (v) {
            // TODO check version
            p.appendChild(document.createTextNode("loading certificate from card, please wait ..."));
            webeid.getCertificate().then(function (c) {
              p.innerHTML = "got certificate";
              m.appendChild(document.createTextNode(c));
              var b = document.createElement("button");
            }).catch(function (e) {
              p.innerHTML = "no card in reader !?";
              // TODO check again OR listen to connect ?
              // https://github.com/web-eid/web-eid.js#webeidconnect
            });
          }).catch(function (e) {
            p.appendChild(document.createTextNode("no webeid"));
          });
        }).catch(function (e) {
            p.appendChild(document.createTextNode("no webeid"));
        });
      </script>

  </body>

</html>
